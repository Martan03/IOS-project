#!/bin/bash

# Gets default editor
# If EDITOR is set, it is used; else VISUAL; else vi
get_editor() {
    editor="vi";
    if [ ! -z "$EDITOR" ]
    then
        editor="$EDITOR";
    elif [ ! -z "$VISUAL" ]
    then
        editor="$VISUAL";
    fi
}

# Opens file with editor chosen by get_editor function
open_file() {
    if [ -z $1 ]
    then
        return 1;
    fi

    get_editor;
    $editor $1;
}

help() {
    echo "Welcome to MOLE by xsleza26!";
    echo "Usage:";
    echo "  mole -h";
    echo "    Displays help";
    echo "  mole [-g GROUP] FILE";
    echo "    Opens file, file opening will be assigned to the group if given";
    echo "  mole [-m] [FILTERS] [DIRECTORY]";
    echo "    Opens file from given directory (or current directory)";
    echo "    If no filters, last edited file will be opened";
    echo "  mole list [FILTERS] [DIRECTORY]";
    echo "    Lists files that were opened/edited with MOLE";
    echo "  mole secret-log [-b DATE] [-a DATE] [DIRECTORY1 [DIRECTORY2] [...]]";
    echo "    Displays a secret log";
    echo "";
    echo "FILTERS:";
    echo "  [-g GROUP1[,GROUP2][,...]";
    echo "     Group specification";
    echo "  [-a DATE]";
    echo "    Records of the opened/edited files after this date";
    echo "  [-b DATE]";
    echo "    Records of the opened/edited files before this date";
    echo "  DATE";
    echo "    In format YYYY-MM-DD"
}

open_file "test";

while getopts :h OPTION
do
    case "${OPTION}" in
    h) help; exit 0;;
    *) echo "Invalid usage. Type: 'mole -h' to show help"; exit 2;;
    esac
done
